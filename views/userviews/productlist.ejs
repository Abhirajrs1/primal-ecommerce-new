<%- include ('header') %>


<!-- nav bar  -->

<header class="header_section">
   <div class="container">
      <nav class="navbar navbar-expand-lg custom_nav-container ">
         <a class="navbar-brand" href="index.html"><img style="height: 9rem;width: auto;"  width="300" src="/assets/images/logo.jpg" alt="#" /></a>
         <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class=""> </span>
         </button>
         <div  class=" navbar-collapse" id="navbarSupportedContent" style="margin-left:10px; margin-top: 10px;font-size: 14px;font-family: Arial, Helvetica, sans-serif;">
            <ul class="navbar-nav" style="margin-left: 30px;">
               <li class="nav-item">
                  <a class="nav-link" href="/">Home <span class="sr-only"></span></a>
               </li>
            
               <li class="nav-item">
                  <a class="nav-link" href="/productlist">Products</a>
               </li>

               <div class="col-4" style="margin-left: 1%;">
                  <form action="/search_userproduct" method="post" class="d-flex align-items-center">
                      <input class="form-control me-2" type="search" placeholder="Search" id="search" name="search">
                      <div >
                          <button style="background-color:black ;color: antiquewhite;padding: 7px;border-radius: 10px;margin-left: 2px;margin-bottom: 20px;">Search
                          </button>
                      </div>
                  </form>
              </div>
              <%if(!user){%>
               <li style="margin-left:50px;" class="nav-item">
                  <a class="nav-link" href="/login">Login</a>
               </li>
               <%}else{%>
               <li class="nav-item">
                  <a class="nav-link" href="/logout">Logout</a>
               </li>
               <%}%>

            

               <li style="margin-left: 10px;"  class="nav-item">
                  <a class="nav-link" href="/cart">
                     <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 456.029 456.029"
                        style="enable-background:new 0 0 456.029 456.029;" xml:space="preserve">
                        <g>
                           <g>
                              <path
                                 d="M345.6,338.862c-29.184,0-53.248,23.552-53.248,53.248c0,29.184,23.552,53.248,53.248,53.248
                                  c29.184,0,53.248-23.552,53.248-53.248C398.336,362.926,374.784,338.862,345.6,338.862z" />
                           </g>
                        </g>
                        <g>
                           <g>
                              <path d="M439.296,84.91c-1.024,0-2.56-0.512-4.096-0.512H112.64l-5.12-34.304C104.448,27.566,84.992,10.67,61.952,10.67H20.48
                                  C9.216,10.67,0,19.886,0,31.15c0,11.264,9.216,20.48,20.48,20.48h41.472c2.56,0,4.608,2.048,5.12,4.608l31.744,216.064
                                  c4.096,27.136,27.648,47.616,55.296,47.616h212.992c26.624,0,49.664-18.944,55.296-45.056l33.28-166.4
                                  C457.728,97.71,450.56,86.958,439.296,84.91z" />
                           </g>
                        </g>
                        <g>
                           <g>
                              <path
                                 d="M215.04,389.55c-1.024-28.16-24.576-50.688-52.736-50.688c-29.696,1.536-52.224,26.112-51.2,55.296
                                  c1.024,28.16,24.064,50.688,52.224,50.688h1.024C193.536,443.31,216.576,418.734,215.04,389.55z" />
                           </g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                     </svg>
                  </a>
               </li>

               



               <%if(user){%>
                  <li class="nav-item">
                     <a class="nav-link" href="/wishlist">
                        <i class="fas fa-heart"></i> 
                     </a>
                  </li>

                  
               <div class="btn-group" >
                  <button style="background-color: white;" type="button" class="nav_search-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      <i class="fa fa-user fa-xl"  aria-hidden="true"></i>
                  </button>
                  <div class="dropdown-menu">
                      <a class="dropdown-item" href="/userprofile">Profile</a>
                      <a class="dropdown-item" href="/orders">Orders</a>
            
                  </div>
              </div>
              <%}%>
              
              
            </ul>
         </div>
      </nav>
   </div>
</header>

<!-- nav end -->


<%-include('cdmlinks')%>

      <style>
          #sidebar {
        width: 100px;
        padding: 20px;
        float: left;
    }
    #categoryForm label {
        display: block;
        white-space: nowrap; /* Prevent line breaks */
    }

    #categoryForm input {
        vertical-align: middle; /* Align radio button with label text */
    }

      </style>
     
      <!-- end inner page section -->
      <!-- product section -->
      <div id="sidebar" class="container">
         <a href="/productlist" class="btn btn-success" style="margin-left: 20px;">&#9003 Clear</a>
         <h3 style="margin-bottom: 30px;margin-top: 40px;"><strong>CATEGORIES</strong></h3>
         <form id="categoryForm" method="post" action="/categoryfilter">
             <% category.forEach((category) => { %>
                 <label style="margin-bottom: 10px;">
                     <input type="radio" name="category" value="<%= category.categoryname %>">
                     <%= category.categoryname %>
                 </label><br>
             <% }) %>
             <button  class="btn btn-block btn-primary font-weight-bold py-2 " style="width: fit-content; margin-left: 50px;margin-bottom: 60px;" type="submit">FILTER</button>

         </form>

         <h3 style="margin-bottom: 30px;margin-top: 40px;white-space: nowrap;"><strong>PRICE RANGE</strong></h3>

         <form id="priceRangeForm" method="post" action="/pricefilter" style="display: flex; flex-direction: column; align-items: flex-start;white-space: nowrap; ">

            <label style="display: flex; align-items: center; margin-bottom: 20px; width: 120px;margin-left: 20px;">
                <input type="radio" name="priceRange" value="1000-1999">
                <span style="margin-left: 20px; font-size: 15px; font-weight: bold;">1000-1999</span>
            </label>
            <!-- Add similar labels for other price ranges -->
            <label style="display: flex; align-items: center; margin-bottom: 20px; width: 120px;margin-left: 20px;">
                <input type="radio" name="priceRange" value="2000-2999">
                <span style="margin-left: 20px; font-size: 15px; font-weight: bold;">2000-2999</span>
            </label>
            <label style="display: flex; align-items: center; margin-bottom: 20px; width: 120px;margin-left: 20px;">
               <input type="radio" name="priceRange" value="3000-3999">
               <span style="margin-left: 20px; font-size: 15px; font-weight: bold;">3000-3999</span>
           </label>
           <label style="display: flex; align-items: center; margin-bottom: 20px; width: 120px;margin-left: 20px;">
            <input type="radio" name="priceRange" value="4000-4999">
            <span style="margin-left: 20px; font-size: 15px; font-weight: bold;">4000-4999</span>
          </label>
          <label style="display: flex; align-items: center; margin-bottom: 20px; width: 120px;margin-left: 20px;">
         <input type="radio" name="priceRange" value="5000-5999">
            <span style="margin-left: 20px; font-size: 15px; font-weight: bold;">5000-5999</span>
         </label>
            <!-- Repeat for other price ranges -->
            <button class="btn btn-block btn-primary font-weight-bold py-2" style="width: fit-content; margin-left: 50px;" type="submit">FILTER</button>
        </form>
     </div> 
      <section class="product_section " >
         <div class="container" style="margin-top: 5px;" >
            <div class="heading_container heading_center">
               <h2>
                  Our <span>products</span>
               </h2>
            </div>
            <div style="margin-left: 190px;" class="row">
               <% data.forEach((item) => { %>
                   <div class="col-md-4">
                       <div class="box">
                           <div class="option_container">
                               <div class="options">
                                   <a href="/product-view?id=<%=item._id%>" class="option1">
                                       VIEW PRODUCT
                                   </a>
                               </div>
                           </div>
                           <div class="img-box">
                               <img src="/productImages/<%=item.image[0] %>" alt="">
                           </div>
                           <div class="detail-box">
                               <h5><%=item.name%></h5>
                               <% if(item.productOffer[0] && item.categoryOffer[0] && item.productOffer[0].enable && item.categoryOffer[0].enable) { %>
                                 <%
                                 const productDiscount=item.price*item.productOffer[0].discount/100
                                 const categoryDiscount=item.price*item.categoryOffer[0].discount/100
                                 const discountedPrice=Math.floor(item.price-Math.max(productDiscount,categoryDiscount))
                                 %>
                                   <h6><del>Rs<%= item.price %></del></h6>
                                   <h6 style="margin-left: 12px;">Rs<%=discountedPrice%></h6>
                               <% }else if(item.productOffer[0] && item.productOffer[0].enable){ %>
                                 <%
                                 const discountedPrice=Math.floor(item.price-(item.price*item.productOffer[0].discount/100))
                                 %>
                                 <h6><del>Rs<%= item.price %></del></h6>
                                 <h6 style="margin-left: 12px;">Rs<%=discountedPrice%></h6>
                               <% }else if(item.categoryOffer[0] && item.categoryOffer[0].enable){ %>
                                 <%
                                 const discountedPrice=Math.floor(item.price-(item.price*item.categoryOffer[0].discount/100))
                                 %>
                                 <h6><del>Rs<%= item.price %></del></h6>
                                 <h6 style="margin-left: 12px;">Rs<%=discountedPrice%></h6>
                                 <%}else{%>
                                    <h6>Rs<%= item.price %></h6>
                                    <%}%>
                           </div>
                       </div>
                   </div>
               <% }) %>
               <div class="text-center my-4">
                  <nav aria-label="Page navigation example">
                      <ul class="pagination">
                          <% for (let i = 1; i <= totalPages; i++) { %>
                              <li class="page-item <%= i === page ? 'active' : '' %>">
                                  <a class="page-link" href="/productlist?page=<%= i %>"><%= i %></a>
                              </li>
                          <% } %>
                      </ul>
                  </nav>
              </div>
         </div>
      </section>
      <!-- end product section -->
      <%-include('footer')%>